query_id,hardness,query_text,ground_truth_sql
"EASY_01","easy","How many products weigh more than 1000g?","SELECT COUNT(product_id) FROM products WHERE product_weight_g > 1000;"
"EASY_02","easy","What are the different payment types used?","SELECT DISTINCT payment_type FROM order_payments;"
"EASY_03","easy","How many sellers are there in the state of 'SP'?","SELECT COUNT(seller_id) FROM sellers WHERE seller_state = 'SP';"
"EASY_04","easy","Show me all the different order statuses.","SELECT DISTINCT order_status FROM orders;"
"EASY_05","easy","What is the product ID for the product with the most photos?","SELECT product_id FROM products ORDER BY product_photos_qty DESC LIMIT 1;"
"MEDIUM_01","medium","What is the total price for all items in the 'health_beauty' category?","SELECT SUM(T1.price) FROM order_items AS T1 INNER JOIN products AS T2 ON T1.product_id = T2.product_id INNER JOIN product_category_name_translation AS T3 ON T2.product_category_name = T3.product_category_name WHERE T3.product_category_name_english = 'health_beauty';"
"MEDIUM_02","medium","How many orders were placed in the month of October 2017?","SELECT COUNT(order_id) FROM orders WHERE order_purchase_timestamp >= '2017-10-01' AND order_purchase_timestamp < '2017-11-01';"
"MEDIUM_03","medium","List the review scores for orders paid by 'boleto'.","SELECT T1.review_score FROM order_reviews AS T1 JOIN order_payments AS T2 ON T1.order_id = T2.order_id WHERE T2.payment_type = 'boleto';"
"MEDIUM_04","medium","What is the average number of payment installments for credit card payments?","SELECT AVG(payment_installments) FROM order_payments WHERE payment_type = 'credit_card';"
"MEDIUM_05","medium","Show the cities of sellers who have sold products in the 'sports_leisure' category.","SELECT DISTINCT T1.seller_city FROM sellers AS T1 JOIN order_items AS T2 ON T1.seller_id = T2.seller_id JOIN products AS T3 ON T2.product_id = T3.product_id JOIN product_category_name_translation AS T4 ON T3.product_category_name = T4.product_category_name WHERE T4.product_category_name_english = 'sports_leisure';"
"HARD_01","hard","List the top 5 cities by the total number of orders. Show the city and the order count.","SELECT T1.customer_city, COUNT(T2.order_id) AS order_count FROM customers AS T1 INNER JOIN orders AS T2 ON T1.customer_id = T2.customer_id GROUP BY T1.customer_city ORDER BY order_count DESC LIMIT 5;"
"HARD_02","hard","What is the average freight value for products weighing more than 5000g?","SELECT AVG(T1.freight_value) FROM order_items AS T1 JOIN products AS T2 ON T1.product_id = T2.product_id WHERE T2.product_weight_g > 5000;"
"HARD_03","hard","Show the product categories and the count of products in each, for categories with more than 1000 products.","SELECT T1.product_category_name_english, COUNT(T2.product_id) FROM product_category_name_translation AS T1 JOIN products AS T2 ON T1.product_category_name = T2.product_category_name GROUP BY T1.product_category_name_english HAVING COUNT(T2.product_id) > 1000;"
"HARD_04","hard","Which seller has the highest average product price? Return the seller ID and their average price.","SELECT seller_id, AVG(price) AS avg_price FROM order_items GROUP BY seller_id ORDER BY avg_price DESC LIMIT 1;"
"HARD_05","hard","List all customers from 'sao paulo' or 'rio de janeiro' who have placed more than one order.","SELECT T1.customer_unique_id FROM customers AS T1 JOIN orders AS T2 ON T1.customer_id = T2.customer_id WHERE T1.customer_city IN ('sao paulo', 'rio de janeiro') GROUP BY T1.customer_unique_id HAVING COUNT(T2.order_id) > 1;"
"EXTRA_HARD_01","extra_hard","Show me watches except those ordered by customers from 'sao paulo'.","SELECT T1.product_id FROM products AS T1 INNER JOIN product_category_name_translation AS T2 ON T1.product_category_name = T2.product_category_name WHERE T2.product_category_name_english = 'watches_gifts' AND T1.product_id NOT IN (SELECT T5.product_id FROM customers AS T3 INNER JOIN orders AS T4 ON T3.customer_id = T4.customer_id INNER JOIN order_items AS T5 ON T4.order_id = T5.order_id WHERE T3.customer_city = 'sao paulo');"
"EXTRA_HARD_02","extra_hard","What is the average price of products in categories that have 'fashion' in their name?","SELECT AVG(T1.price) FROM order_items AS T1 JOIN products AS T2 ON T1.product_id = T2.product_id JOIN product_category_name_translation AS T3 ON T2.product_category_name = T3.product_category_name WHERE T3.product_category_name_english LIKE '%fashion%';"
"EXTRA_HARD_03","extra_hard","Find the customer who has spent the most money. Return their unique ID and the total amount spent.","SELECT T1.customer_unique_id, SUM(T3.payment_value) AS total_spent FROM customers AS T1 JOIN orders AS T2 ON T1.customer_id = T2.customer_id JOIN order_payments AS T3 ON T2.order_id = T3.order_id GROUP BY T1.customer_unique_id ORDER BY total_spent DESC LIMIT 1;"
"EXTRA_HARD_04","extra_hard","List the product categories that have an average review score lower than 3.","SELECT T1.product_category_name_english FROM product_category_name_translation AS T1 JOIN products AS T2 ON T1.product_category_name = T2.product_category_name JOIN order_items AS T3 ON T2.product_id = T3.product_id JOIN order_reviews AS T4 ON T3.order_id = T4.order_id GROUP BY T1.product_category_name_english HAVING AVG(T4.review_score) < 3;"
"EXTRA_HARD_05","extra_hard","Which products were sold in orders that also contained a product from the 'books_technical' category?","SELECT DISTINCT T1.product_id FROM order_items AS T1 WHERE T1.order_id IN (SELECT T2.order_id FROM order_items AS T2 JOIN products AS T3 ON T2.product_id = T3.product_id JOIN product_category_name_translation AS T4 ON T3.product_category_name = T4.product_category_name WHERE T4.product_category_name_english = 'books_technical') AND T1.product_id NOT IN (SELECT T2.product_id FROM products AS T2 JOIN product_category_name_translation AS T3 ON T2.product_category_name = T3.product_category_name WHERE T3.product_category_name_english = 'books_technical');"